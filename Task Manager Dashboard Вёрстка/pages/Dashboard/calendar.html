<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Календарь задач TASKFLOW</title>
  <link rel="stylesheet" href="globals.css" />
  <link rel="stylesheet" href="styleguide.css" />
  <link rel="stylesheet" href="tasks.css" />
  <style>
    /* === Меню и шапка из твоего CSS === */
    .hhhhv {
      background-color: #f3f4f8;
      display: flex;
      flex-direction: row;
      justify-content: center;
      width: 100%;
    }

    .hhhhv .overlap-wrapper {
      background-color: #f3f4f8;
      overflow: hidden;
      width: 1440px;
      height: 1024px;
    }

    .hhhhv .overlap {
      position: relative;
      width: 1441px;
      height: 1024px;
      left: -1px;
    }

    .hhhhv .overlap-group {
      position: absolute;
      width: 1441px;
      height: 1024px;
      top: 0;
      left: 0;
    }

    .hhhhv .rectangle {
      width: 1440px;
      height: 64px;
      left: 1px;
      background-color: #fbfaff;
      position: absolute;
      top: 0;
    }

    .hhhhv .div {
      width: 253px;
      height: 1024px;
      left: 0;
      background-color: #fbfaff;
      position: absolute;
      top: 0;
    }

    .hhhhv .frame {
      width: 252px;
      height: 48px;
      padding: 0px 24px 24px;
      position: absolute;
      top: 975px;
      left: 1px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hhhhv .menu {
      gap: 8px;
      padding: 0px 0px 0px 5px;
      display: flex;
      align-items: center;
      position: relative;
      flex: 1;
      flex-grow: 1;
    }

    .hhhhv .img {
      position: relative;
      width: 24px;
      height: 24px;
    }

    .hhhhv .home {
      position: relative;
      width: 111px;
      height: 14px;
      color: #768396;
      font-family: "Roboto-Regular", Helvetica;
      font-weight: 400;
      font-size: 16px;
      letter-spacing: 0.32px;
      line-height: 20px;
      white-space: nowrap;
    }

    .hhhhv .wireframes-logo {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      position: absolute;
      top: 20px;
      left: 32px;
    }

    .hhhhv .planit {
      position: relative;
      width: fit-content;
      font-family: "Montserrat-Regular", Helvetica;
      font-weight: 400;
      color: #232360;
      font-size: 18px;
      letter-spacing: 0;
      line-height: normal;
    }

    .hhhhv .elements {
      display: none;
    }

    .hhhhv .vector,
    .hhhhv .vector-2,
    .hhhhv .vector-3,
    .hhhhv .vector-4 {
      position: absolute;
      width: 8px;
      height: 8px;
      top: 7px;
      left: 7px;
      background: transparent;
    }

    .hhhhv .side-menu {
      display: inline-flex;
      flex-direction: column;
      align-items: flex-start;
      position: absolute;
      top: 64px;
      left: 2px;
    }

    .hhhhv .section {
      padding: 24px 8px 24px 24px;
      display: flex;
      flex-direction: column;
      width: 252px;
      align-items: flex-start;
      gap: 16px;
      position: relative;
      flex: 0 0 auto;
    }

    .hhhhv .frame-2 {
      width: 220px;
      height: 34px;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hhhhv .text-wrapper {
      position: relative;
      width: 111px;
      height: 14px;
      color: #232360;
      font-family: "Roboto-Regular", Helvetica;
      font-weight: 400;
      font-size: 16px;
      letter-spacing: 0.32px;
      line-height: 20px;
      white-space: nowrap;
    }

    .hhhhv .section-2 ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }

    .hhhhv .section-2 li.has-dropdown {
      position: relative;
      cursor: pointer;
      padding-right: 20px;
      user-select: none;
    }

    .hhhhv .section-2 li.has-dropdown::after {
      content: "▼";
      position: absolute;
      right: 60px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 10px;
      color: #768396;
      transition: transform 0.3s ease;
    }

    .hhhhv .section-2 li.has-dropdown.active::after {
      transform: translateY(-50%) rotate(180deg);
    }

    .hhhhv .section-2 ul.submenu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      margin-top: 8px;
      padding-left: 16px;
    }

    .hhhhv .section-2 li.has-dropdown.active > ul.submenu {
      max-height: 400px;
    }

    .hhhhv .section-2 ul.submenu li {
      padding: 4px 0;
      color: #768396;
      font-family: "Roboto-Regular", Helvetica;
      font-size: 14px;
    }

    .hhhhv .section-2 ul.submenu li:hover {
      color: #5051f9;
      cursor: pointer;
    }

    /* === Календарь === */

    .main {
  position: absolute;
  top: 250px; /* увеличено */
  left: 277px;
  right: 20px;
  bottom: 20px;
  background: #f8f9ff;
  border-radius: 12px;
  padding: 20px;
  overflow-x: auto;
  overflow-y: visible;
  box-sizing: border-box;
}


    .calendar-header {
      display: grid;
      grid-template-columns: 80px repeat(31, 40px);
      border-bottom: 1px solid #ddd;
      padding-bottom: 10px;
      font-weight: 600;
      color: #5051f9;
      font-family: "Roboto", sans-serif;
      font-size: 14px;
      user-select: none;
    }

    .calendar-header .header-name {
      grid-column: 1 / 2;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding-left: 10px;
    }

    .calendar-header .day {
      text-align: center;
      line-height: 24px;
    }

    .tasks-list {
      display: grid;
      grid-template-columns: 80px repeat(31, 40px);
      grid-auto-rows: 40px;
      gap: 8px;
      margin-top: 20px;
    }

    .tasks-list .task-name-cell {
      display: flex;
      align-items: center;
      padding-left: 10px;
      font-weight: 600;
      color: #232360;
      font-family: "Roboto", sans-serif;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      background: transparent;
    }

    .task-bar {
      position: relative;
      border-radius: 20px;
      color: white;
      font-size: 13px;
      font-weight: 600;
      padding: 5px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: default;
      user-select: none;
    }

    .task-bar .status, .task-bar .percent {
      background: rgba(255 255 255 / 0.9);
      color: #232360;
      font-weight: 500;
      font-size: 12px;
      border-radius: 12px;
      padding: 3px 7px;
      white-space: nowrap;
    }

    .task-bar .percent {
      background: rgba(255 255 255 / 0.5);
    }

    /* Цвета для задач */
    .color-1 { background-color: #5051f9; }
    .color-2 { background-color: #ffa98a; }
    .color-3 { background-color: #90caff; }
    .color-4 { background-color: #ffb38c; }
    .color-5 { background-color: #d1d1fc; }

    /* Горизонтальная прокрутка */
    .main::-webkit-scrollbar {
      height: 10px;
    }
    .main::-webkit-scrollbar-thumb {
      background: #768396;
      border-radius: 5px;
    }
    .main::-webkit-scrollbar-track {
      background: #f3f4f8;
    }

     /* Модальное окно */
  #addTaskModal {
    position: fixed;
    top: 0; left: 0; right:0; bottom: 0;
    background: rgba(0,0,0,0.4);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  #addTaskModal.active {
    display: flex;
  }
  #addTaskModal .modal-content {
    background: white;
    padding: 20px;
    border-radius: 8px;
    width: 320px;
  }
  #addTaskModal label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }
  #addTaskModal input, #addTaskModal select {
    width: 100%;
    margin-bottom: 12px;
    padding: 6px 8px;
    font-size: 14px;
  }
  #addTaskModal button {
    width: 100%;
  }

  /* Фоновая заливка по всей длине задачи с плавным цветом */
.task-bar::before {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  border-radius: 20px;
  background: linear-gradient(90deg, #5051f9 0%, #a4a8f7 100%);
  opacity: 0.3; /* чуть прозрачный фон */
  z-index: 0;
}

/* Содержимое на переднем плане */
.task-bar > * {
  position: relative;
  z-index: 1;
  background: white;
  border-radius: 12px;
  padding: 4px 8px;
  color: #232360;
  font-weight: 500;
  font-size: 12px;
  white-space: nowrap;
}

.task-bar .task-name-pill {
  background-color: #5051f9;
  color: white;
  padding: 6px 12px;
  border-radius: 20px;
  font-weight: 600;
  font-size: 14px;
}

.task-bar .status {
  background-color: white;
  border-radius: 12px;
  padding: 4px 8px;
  font-weight: 500;
  font-size: 12px;
  color: #5051f9;
  opacity: 0.9;
}

.task-bar .percent {
  background-color: white;
  border-radius: 12px;
  padding: 4px 8px;
  font-weight: 500;
  font-size: 12px;
  color: #5051f9;
  opacity: 0.9;
}
  </style>
</head>
<body>
  <div class="hhhhv">
    <div class="overlap-wrapper">
      <div class="overlap">
        <div class="overlap-group">
          <div class="rectangle"></div>
          <div class="div"></div>
          <div class="frame">
            <div class="menu">
              <img class="img" src="img/Wireframes - Icons.svg" alt="Icon" />
              <div class="home">ВЫЙТИ</div>
            </div>
          </div>
          <div class="wireframes-logo">
            <img class="img" src="img/calendar-outline.svg" alt="Calendar" />
            <div class="planit">TASKFLOW</div>
          </div>
          <div class="elements"></div>
          <div class="side-menu">
            <div class="section">
              <div class="frame-2">
                <a href="Main.html" style="text-decoration:none; color:inherit;">
                  <div class="menu">
                    <img class="img" src="img/wireframes - icons - 4.svg" alt="Icon" />
                    <div class="home">ГЛАВНАЯ</div>
                  </div>
                </a>
              </div>
                            <div class="frame-2">
                <a href="calendar.html" style="text-decoration:none; color:inherit; display:flex;">
                  <div class="menu">
                    <img class="img" src="img/Vector2222222.svg" alt="Icon" />
                    <div class="home">КАЛЕНДАРЬ</div>
                  </div>
                </a>
              </div>
              <div class="frame-2">
                <a href="tasks.html" style="text-decoration:none; color:inherit; display:flex;">
                  <div class="menu">
                    <div class="icon-container">
                      <img class="img" src="img/elements.svg" />
                    </div>
                    <div class="text-wrapper">ТАБЛИЦА</div>
                  </div>
                </a>
              </div>
              <div class="section-2">
                <ul>
                  <li class="has-dropdown">
                    <div class="menu">
                      <img class="img" src="img/wireframes-icons-3.svg" alt="Icon" />
                      <div class="home">КОМАНДЫ</div>
                    </div>
                    <ul class="submenu">
                      <li><a href="team_1.html"><img src="img/Frame 1000004546222.svg" alt="Команда1" class="menu-icon" /></a></li>
                      <li><a href="team_2.html"><img src="img/Frame 1000004547222.svg" alt="Команда2" class="menu-icon" /></a></li>
                      <li><a href="team_3.html"><img src="img/Frame 1000004548222.svg" alt="Команда3" class="menu-icon" /></a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
            <div class="row">
              <div class="wireframes-input">
                <div class="actions-UI-search">
                  <img class="union" src="img/union.svg" alt="Search" />
                </div>
                <input type="text" class="search-input" placeholder="Поиск" />
              </div>
              <img class="wireframes-icons-2" src="img/wireframes-icons-2.svg" alt="Icon" />
              <img class="wireframes-icons-2" src="img/wireframes-icons-6.svg" alt="Icon" />
              <a href="dashboard.html" class="wireframes-avatar">
                <img class="intersect" src="img/intersect.svg" alt="User" />
              </a>
            </div>
          </div>

          <div class="main">
            <header class="header">
              <div class="mode">
                <div class="left"><div class="on">Таблица</div></div>
                <div class="right"><div class="off">Календарь</div></div>
              </div>
              <div class="group-10">
                <div class="overlap-group-4" style="position: relative;">
                  <button id="filtersBtn" class="filters-button">
                    <div class="text-wrapper-9">Фильтры</div>
                    <img class="wireframes-icons-3" src="img/wireframes-icons-5.svg" alt="Filters" />
                  </button>
                  <div id="filtersDropdown" class="filters-dropdown-menu">
                    <button class="dropdown-item">
                      <img src="img/participants.svg" alt="Участники" class="icon" />
                      Участники
                    </button>
                    <button class="dropdown-item">
                      <img src="img/responsible.svg" alt="Ответственный" class="icon" />
                      Ответственный
                    </button>
                    <button class="dropdown-item">
                      <img src="img/deadline.svg" alt="Срок" class="icon" />
                      Срок
                    </button>
                    <button class="dropdown-item">
                      <img src="img/status.svg" alt="Статус" class="icon" />
                      Статус
                    </button>
                  </div>
                </div>
              </div>
              <div class="group-11">
                <div class="overlap-3" id="addTaskBtn" style="cursor:pointer;">
                  <div class="text-wrapper-10">Добавить</div>
                  <img class="wireframes-icons-4" src="img/wireframes-icons1.svg" alt="Add" />
                </div>
              </div>
              
            </header>
             <li> 
             </li>
             <li> 
             </li>
            <!-- Календарь -->
            <div class="calendar-header">
              <div class="header-name">Задачи / Дни</div>
              <!-- JS создаст дни -->
            </div>
            <div class="tasks-list" id="tasksList">
              <!-- JS вставит задачи -->
            </div>
            <div class="controls">
  <button id="prevMonthBtn">← Предыдущий месяц</button>
  <button id="nextMonthBtn">Следующий месяц →</button>

  <select id="statusFilter">
    <option value="all">Все статусы</option>
    <option value="new">Новые</option>
    <option value="in-progress">В работе</option>
    <option value="done">Выполненные</option>
  </select>
</div>

<div class="calendar-header" id="calendarHeader">
  <div class="header-name">Дни</div>
  <!-- Дни будут добавлены динамически -->
</div>

<div class="controls">
  <button id="prevDayBtn">← Предыдущий день</button>
  <button id="nextDayBtn">Следующий день →</button>

  <select id="statusFilter">
    <option value="all">Все статусы</option>
    <option value="new">Новые</option>
    <option value="in-progress">В работе</option>
    <option value="done">Выполненные</option>
  </select>

  <button id="openAddTaskBtn">Добавить задачу</button>
</div>

<div class="calendar-header" id="calendarHeader">
  <div class="header-name">Дни</div>
  <!-- Дни будут добавлены динамически -->
</div>

<div class="tasks-list" id="tasksList">
  <!-- Задачи будут добавлены динамически -->
</div>

<!-- Модальное окно для добавления задачи -->
<div id="addTaskModal">
  <div class="modal-content">
    <h3>Добавить задачу</h3>
    <form id="addTaskForm">
      <label for="taskName">Название</label>
      <input id="taskName" type="text" required />

      <label for="startDay">Дата начала (день)</label>
      <input id="startDay" type="number" min="1" max="31" required />

      <label for="duration">Длительность (дней)</label>
      <input id="duration" type="number" min="1" max="31" required />

      <label for="status">Статус</label>
      <select id="status" required>
        <option value="new">Новые</option>
        <option value="in-progress">В работе</option>
        <option value="done">Выполненные</option>
      </select>

      <button type="submit">Добавить</button>
      <button type="button" id="closeModalBtn" style="margin-top:8px;">Отмена</button>
    </form>
  </div>
  <div class="task-bar">
  <div class="task-name-pill">Имя задачи</div>
  <div class="status">Статус</div>
  <div class="percent">75%</div>
</div>


          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // Выпадающее меню "Команды"
  document.querySelectorAll(".section-2 li.has-dropdown").forEach(item => {
    item.addEventListener("click", e => {
      if (e.target.closest(".submenu")) return;
      item.classList.toggle("active");
      document.querySelectorAll(".section-2 li.has-dropdown").forEach(other => {
        if (other !== item && other.classList.contains("active")) {
          other.classList.remove("active");
        }
      });
    });
  });

  // Выпадающее меню "Фильтры"
  const filtersBtn = document.getElementById('filtersBtn');
  const filtersDropdown = document.getElementById('filtersDropdown');

  filtersBtn.addEventListener('click', e => {
    e.stopPropagation();
    filtersDropdown.classList.toggle('active');
  });

  window.addEventListener('click', () => {
    filtersDropdown.classList.remove('active');
  });
  

   const calendarHeader = document.getElementById('calendarHeader');
  const tasksList = document.getElementById('tasksList');
  const statusFilter = document.getElementById('statusFilter');
  const prevDayBtn = document.getElementById('prevDayBtn');
  const nextDayBtn = document.getElementById('nextDayBtn');
  const openAddTaskBtn = document.getElementById('openAddTaskBtn');
  const addTaskModal = document.getElementById('addTaskModal');
  const addTaskForm = document.getElementById('addTaskForm');
  const closeModalBtn = document.getElementById('closeModalBtn');

  // Текущий отображаемый день (начинаем с 1)
  let currentStartDay = 1;

  // Пример задач
  let tasks = [
   
  ];

  function renderCalendar() {
    const daysCount = 31; // фиксируем для простоты
    calendarHeader.innerHTML = '<div class="header-name">Дни</div>';
    for(let i = 1; i <= daysCount; i++) {
      const dayDiv = document.createElement('div');
      dayDiv.classList.add('day');
      dayDiv.textContent = i.toString().padStart(2, '0');
      calendarHeader.appendChild(dayDiv);
    }

    tasksList.innerHTML = '';

    // Фильтрация задач по статусу
    const filteredTasks = statusFilter.value === 'all' ? tasks : tasks.filter(t => t.status === statusFilter.value);

    filteredTasks.forEach(task => {
      // Добавим имя задачи в первый столбец
      const nameCell = document.createElement('div');
      nameCell.classList.add('task-name-cell');
      nameCell.textContent = task.name;
      tasksList.appendChild(nameCell);

      for(let i = 1; i <= daysCount; i++) {
        const cell = document.createElement('div');

        if(i >= task.startDay && i < task.startDay + task.duration) {
          const taskBar = document.createElement('div');
          taskBar.classList.add('task-bar', task.colorClass);
          taskBar.textContent = task.name;
          cell.appendChild(taskBar);
        }
        tasksList.appendChild(cell);
      }
    });
  }

  // Кнопки переключения дня (для примера просто меняем currentStartDay)
  prevDayBtn.onclick = () => {
    if(currentStartDay > 1) {
      currentStartDay--;
      alert(`Показать задачи, начиная с дня ${currentStartDay} (функция для будущего расширения)`);
    }
  };

  nextDayBtn.onclick = () => {
    if(currentStartDay < 31) {
      currentStartDay++;
      alert(`Показать задачи, начиная с дня ${currentStartDay} (функция для будущего расширения)`);
    }
  };

  // Фильтр по статусу
  statusFilter.onchange = () => {
    renderCalendar();
  };

  // Открыть и закрыть модалку
  openAddTaskBtn.onclick = () => {
    addTaskModal.classList.add('active');
  };
  closeModalBtn.onclick = () => {
    addTaskModal.classList.remove('active');
  };

  // Обработка формы добавления задачи
  addTaskForm.onsubmit = (e) => {
    e.preventDefault();
    const name = addTaskForm.taskName.value.trim();
    const startDay = Number(addTaskForm.startDay.value);
    const duration = Number(addTaskForm.duration.value);
    const status = addTaskForm.status.value;

    if(name && startDay > 0 && startDay <= 31 && duration > 0 && duration <= 31) {
      // Определим цвет по статусу
      let colorClass = "color-5";
      if(status === "new") colorClass = "color-1";
      else if(status === "in-progress") colorClass = "color-2";
      else if(status === "done") colorClass = "color-3";

      tasks.push({ name, startDay, duration, status, colorClass });

      addTaskModal.classList.remove('active');
      addTaskForm.reset();
      renderCalendar();
    } else {
      alert("Пожалуйста, заполните все поля корректно.");
    }
  };

  // Начальный рендер
  renderCalendar();
</script>
</script>
</body>
</html>
